<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Web Play GUI</title>
<style>
  body {
    margin: 0;
    font-family: sans-serif;
    background-color: #000;
    color: #fff;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }

  #topBar {
    background-color: #111;
    padding: 10px 20px;
    display: flex;
    justify-content: center;
    position: sticky;
    top: 0;
    border-bottom: 2px solid #ff0000;
    z-index: 1000;
  }

  #searchInput {
    background-color: #000;
    color: #ff0000;
    border: 2px solid #ff0000;
    border-radius: 6px;
    padding: 8px 12px;
    font-size: 16px;
    width: 100%;
    max-width: 400px;
    outline: none;
  }

  #itemsContainer {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    justify-content: center;
    gap: 20px;
    padding: 20px;
    flex: 1;
  }

  .item {
    background-color: #111;
    border: 2px solid #ff0000;
    border-radius: 8px;
    padding: 15px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    transition: 0.2s;
  }

  .item:hover {
    background-color: #222;
  }

  .item button {
    background-color: #ff0000;
    border: none;
    padding: 8px;
    color: #fff;
    cursor: pointer;
    border-radius: 4px;
    font-weight: bold;
  }

  .item button:hover {
    background-color: #cc0000;
  }

  #credit {
    text-align: right;
    padding: 10px 20px;
    font-size: 12px;
    color: #fff;
  }
</style>
</head>
<body>

<div id="topBar">
  <input type="text" id="searchInput" placeholder="Search programs...">
</div>

<div id="itemsContainer"></div>

<div id="credit">Made By GLITCH OVERRIDE</div>

<script>
const container = document.getElementById('itemsContainer');
const searchInput = document.getElementById('searchInput');
const jsonURL = "https://raw.githubusercontent.com/GLITCHED-OVERRIDE/Web-store/refs/heads/main/Assets/APPS/Main.json";
let appsData = [];

async function loadApps() {
  try {
    const res = await fetch(jsonURL);
    if (!res.ok) throw new Error("Failed to fetch JSON");
    appsData = await res.json(); 

    renderApps(appsData);
  } catch (err) {
    container.innerHTML = "<p style='color:red'>Failed to load apps from GitHub.</p>";
    console.error(err);
  }
}

function renderApps(apps) {
  container.innerHTML = "";
  apps.forEach(app => {
    const div = document.createElement('div');
    div.className = 'item';

    const name = document.createElement('span');
    name.textContent = app.name;

    const downloadBtn = document.createElement('button');
    downloadBtn.textContent = "Download (.html)";
    downloadBtn.addEventListener('click', async () => {
      try {
        const fileRes = await fetch(app.raw_url);
        if (!fileRes.ok) throw new Error("Failed to fetch file");
        const blob = await fileRes.blob();

        let fileName = app.name;
        if (!fileName.toLowerCase().endsWith(".html")) {
          fileName += ".html";
        }

        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = fileName;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
      } catch (err) {
        alert(`Failed to download "${app.name}"`);
        console.error(err);
      }
    });

    div.appendChild(name);
    div.appendChild(downloadBtn);
    container.appendChild(div);
  });
}

// Filter apps as user types
searchInput.addEventListener('input', () => {
  const query = searchInput.value.toLowerCase();
  const filtered = appsData.filter(app => app.name.toLowerCase().includes(query));
  renderApps(filtered);
});

loadApps();
</script>

</body>
  </html>
